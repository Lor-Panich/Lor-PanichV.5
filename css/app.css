/* ======================================================
   V5 BASE
   iOS 26 ‚Äì Liquid Glass
   Light + Dark Mode Ready
====================================================== */

/* ======================================================
   1. CSS RESET / BASE
====================================================== */

*,
*::before,
*::after {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 0;

  width: 100%;
  min-height: 100dvh; /* üîë safer on mobile */

  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  -webkit-font-smoothing: antialiased;

  background: var(--app-bg);
  color: var(--text-primary);

  overflow-x: hidden;
}

/* ======================================================
   2. DESIGN TOKENS
====================================================== */

:root {
  --app-bg: #f2f2f7;

  --text-primary: #1c1c1e;
  --text-secondary: #5f6368;

  --accent: #007aff;
  --danger: #ff3b30;
  --success: #34c759;

  --glass-bg: rgba(255, 255, 255, 0.75);
  --glass-border: rgba(255, 255, 255, 0.35);
  --glass-shadow:
    0 20px 50px rgba(0, 0, 0, 0.18),
    inset 0 1px 0 rgba(255, 255, 255, 0.6);

  --glass-blur: blur(24px) saturate(1.3);

  --radius-sm: 12px;
  --radius-md: 16px;
  --radius-lg: 24px;

  --ease-out: cubic-bezier(.2,.8,.2,1);
}

@media (prefers-color-scheme: dark) {
  :root {
    --app-bg: #000;

    --text-primary: #f5f5f7;
    --text-secondary: #a1a1a6;

    --accent: #0a84ff;
    --danger: #ff453a;
    --success: #32d74b;

    --glass-bg: rgba(28, 28, 30, 0.75);
    --glass-border: rgba(255, 255, 255, 0.12);

    --glass-shadow:
      0 20px 60px rgba(0, 0, 0, 0.6),
      inset 0 1px 0 rgba(255, 255, 255, 0.08);

    --glass-blur: blur(28px) saturate(1.4);
  }
}

/* ======================================================
   3. APP ROOT
====================================================== */

#app {
  min-height: 100dvh;
  padding-bottom: env(safe-area-inset-bottom);
}

/* ======================================================
   4. APP HEADER (Glass)
====================================================== */

#appHeader {
  position: sticky;
  top: 0;
  z-index: 20;

  padding:
    calc(14px + env(safe-area-inset-top))
    16px
    14px;

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  border-bottom: 1px solid var(--glass-border);

  box-shadow:
    0 1px 0 rgba(0,0,0,.04),
    0 4px 12px rgba(0,0,0,.06);

  /* ‚ú® polish ‚Äî make glass feel ‚Äúalive‚Äù */
  transition:
    backdrop-filter 220ms ease,
    box-shadow 220ms ease;
}

/* ======================================================
   HEADER LAYOUT
====================================================== */

.shop-header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.shop-header {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
  min-width: 0;
}

.shop-title {
  font-size: 22px;
  font-weight: 600;
  letter-spacing: -0.2px;
  line-height: 1.2;
}

.shop-subtitle {
  font-size: 14px;
  color: var(--text-secondary);
}

/* ======================================================
   SEARCH BAR (SUB HEADER)
====================================================== */

.search-bar {
  padding: 12px 16px;
  background: var(--app-bg);

  pointer-events: none;
  opacity: 0;
}
body.search-open .search-bar {
  pointer-events: auto;
}

.search-input {
  width: 100%;
  padding: 10px 14px;

  font-size: 16px;
  border-radius: 14px;

  border: 1px solid var(--glass-border);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);

  color: var(--text-primary);
  outline: none;
}

/* ======================================================
   ‚ú® SEARCH BAR ANIMATION (Unified)
   iOS 26 / Liquid Glass
====================================================== */

.search-bar {
  position: relative;

  transform: translateY(-18px) scale(0.96);
  opacity: 0;

transition:
  transform 320ms cubic-bezier(.2,.8,.2,1) 40ms,
  opacity 220ms ease 40ms;
}

/* when search is active */
body.search-open .search-bar {
  transform: translateY(0) scale(0.995);
  opacity: 1;
}

/* input base transition */
.search-input {
  transition:
    background 160ms ease,
    transform 160ms ease,
    box-shadow 220ms ease;
}

/* focus micro-interaction */
.search-input:focus {
  transform: scale(1.01);
  box-shadow:
    0 10px 30px rgba(0,0,0,.14),
    inset 0 1px 0 rgba(255,255,255,.6);
}

/* glass morph when search is open (not only focus) */
body.search-open .search-input {
  box-shadow:
    0 8px 30px rgba(0,0,0,.12),
    inset 0 1px 0 rgba(255,255,255,.6);
}

/* ======================================================
   HEADER ICON BUTTON (Unified)
   iOS 26 / Liquid Glass
====================================================== */

.header-icon-btn {
  appearance: none;
  border: none;
  background: transparent;

  width: 36px;
  height: 36px;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 20px;
  line-height: 1;
  color: var(--text-primary);

  border-radius: 10px;
  cursor: pointer;

  transition:
    transform 120ms ease,
    background 120ms ease,
    opacity 120ms ease;
}

.header-icon-btn:active {
  transform: scale(0.92);
  background: rgba(0,0,0,0.04);
}

@media (prefers-color-scheme: dark) {
  .header-icon-btn:active {
    background: rgba(255,255,255,0.12);
  }
}

/* ======================================================
   5. OVERLAY / GLOBAL UI
====================================================== */

.overlay {
  position: fixed;
  inset: 0;
  z-index: 1000;

  background: rgba(0,0,0,.28);
  opacity: 0;
  pointer-events: none;

  transition: opacity .25s var(--ease-out);
}

.overlay.show {
  opacity: 1;
  pointer-events: auto;
}

/* ======================================================
   TOAST CONTAINER ‚Äî iOS Floating Zone
====================================================== */

#toastContainer {
  position: fixed;
  top: calc(env(safe-area-inset-top, 12px) + 8px);
  left: 50%;
  transform: translateX(-50%);

  display: flex;
  flex-direction: column;
  gap: 8px;

  z-index: 3000;

  pointer-events: none; /* üîë toast ‡πÑ‡∏°‡πà block UI */
}

/* ======================================================
   TOAST ‚Äî iOS Soft Pop
====================================================== */

.toast {
  min-width: 220px;
  max-width: 86vw;

  padding: 12px 16px;

  font-size: 14px;
  font-weight: 500;
  text-align: center;

  color: var(--text-primary);

  border-radius: 14px;
  border: 1px solid var(--glass-border);

  background: var(--glass-bg);
  backdrop-filter: blur(12px) saturate(1.1);
  -webkit-backdrop-filter: blur(12px) saturate(1.1);

  box-shadow:
    0 10px 28px rgba(0,0,0,.18),
    inset 0 1px 0 rgba(255,255,255,.6);

  /* ‚ú® entrance animation */
  opacity: 0;
  transform: translateY(-6px) scale(0.96);

  animation: toast-in 320ms cubic-bezier(.2,.8,.2,1) forwards;
}

/* exit handled by JS remove() ‚Äî fade naturally */

/* ======================================================
   TOAST ANIMATION
====================================================== */

@keyframes toast-in {
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}



#loadingOverlay {
  position: fixed;
  inset: 0;
  z-index: 4000;

  display: flex;
  align-items: center;
  justify-content: center;

  background: rgba(0,0,0,.35);
}

#loadingOverlay.hidden {
  display: none;
}

/* ======================================================
   UTILITIES
====================================================== */

.hidden {
  display: none !important;
}

/* ======================================================
   6. PRODUCT CARD (V5)
   iOS 26 / Liquid Glass
====================================================== */
.product-card {
  display: flex;
  gap: 14px;

  padding: 14px;
  margin: 12px 16px;

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  border-radius: var(--radius-lg);
  border: 1px solid var(--glass-border);

  box-shadow: var(--glass-shadow);

  cursor: pointer;

  /* üîë iOS-style staggered motion */
  transition:
    transform 90ms cubic-bezier(.2,.8,.2,1),
    box-shadow 180ms cubic-bezier(.2,.8,.2,1),
    background 220ms ease;
}

/* iOS list cell tap */
.product-card:active {
  transform: scale(0.985);

  box-shadow:
    0 6px 22px rgba(0,0,0,.18),
    inset 0 1px 0 rgba(255,255,255,.55);
}

/* ======================================================
   PRODUCT THUMB (iOS Liquid Glass ‚Ä¢ No Placeholder Feel)
====================================================== */

.product-thumb {
  width: 72px;
  height: 72px;
  flex-shrink: 0;

  position: relative;
  overflow: hidden;

  border-radius: var(--radius-md);

  /* Glass material instead of grey placeholder */
  background:
    linear-gradient(
      120deg,
      rgba(255,255,255,.18),
      rgba(255,255,255,.08)
    );

  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

/* image base (before decode) */
.product-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;

  opacity: 0;
  filter: blur(6px);
  transform: scale(1.03);

  will-change: opacity, transform;

  transition:
    opacity 240ms ease,
    filter 320ms ease,
    transform 320ms cubic-bezier(.2,.8,.2,1);
}

/* image decoded / ready */
.product-thumb img[src]:not([src=""]) {
  opacity: 1;
  filter: blur(0);
  transform: scale(1);
}

.product-info {
  flex: 1;
  min-width: 0;

  display: flex;
  flex-direction: column;
  gap: 4px;
}

.product-name {
  font-size: 16px;
  font-weight: 600;
  line-height: 1.25;
  letter-spacing: -0.2px;
}

.product-code {
  font-size: 13px;
  color: var(--text-secondary);
}

.product-price {
  margin-top: 4px;

  font-size: 20px;
  font-weight: 700;
  color: var(--accent);
}

.product-stock {
  display: flex;
  align-items: center;
  gap: 8px;

  font-size: 13px;
  color: var(--text-secondary);
}

.stock-badge {
  padding: 4px 10px;
  border-radius: 999px;

  font-size: 12px;
  font-weight: 600;
}

.stock-badge.ready {
  background: rgba(52,199,89,.15);
  color: var(--success);
}

.stock-badge.out {
  background: rgba(255,59,48,.15);
  color: var(--danger);
}

.product-card.is-out {
  opacity: 0.55;
}

.sheet-handle {
  width: 36px;
  height: 5px;
  margin: 10px auto 8px;

  border-radius: 999px;

  /* ‚ú® layered glass look */
  background:
    linear-gradient(
      to bottom,
      rgba(255,255,255,.55),
      rgba(0,0,0,.18)
    );

  box-shadow:
    0 1px 2px rgba(0,0,0,.18),
    inset 0 1px 0 rgba(255,255,255,.7);

  /* subtle motion readiness */
  transition:
    transform 180ms cubic-bezier(.2,.8,.2,1),
    opacity 180ms ease;
}

/* micro feedback when user touches sheet */
.overlay.show .product-detail-sheet:active .sheet-handle {
  transform: scale(0.96);
  opacity: 0.75;
}

@media (prefers-color-scheme: dark) {
  .sheet-handle {
    background:
      linear-gradient(
        to bottom,
        rgba(255,255,255,.45),
        rgba(255,255,255,.18)
      );

    box-shadow:
      0 1px 2px rgba(0,0,0,.45),
      inset 0 1px 0 rgba(255,255,255,.18);
  }
}


/* ======================================================
   STEP 9.3.x ‚Äî Product Detail Sheet Size (Unified)
   - remove duplicate max-width / max-height
   - improve optical balance (iOS-like)
====================================================== */

.product-detail-sheet {
  max-width: 86%;
  max-height: 84dvh;
}

/* ======================================================
   Product Image (1:1 ‚Ä¢ Centered ‚Ä¢ No placeholder feeling)
====================================================== */

.product-detail-sheet .product-image-wrap {
  width: 100%;
  max-width: 260px;          /* üîë visual anchor */
  aspect-ratio: 1 / 1;

  margin: 16px auto 0;       /* üîß ‡πÄ‡∏û‡∏¥‡πà‡∏° breathing room ‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */

  overflow: hidden;
  border-radius: var(--radius-lg);

  /* glass-like neutral surface (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô placeholder) */
  background:
    linear-gradient(
      120deg,
      rgba(255,255,255,.18),
      rgba(255,255,255,.08)
    );
}

/* image */
.product-detail-sheet .product-image-wrap img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center center;
}


/* ======================================================
   PRODUCT DETAIL CONTENT ‚Äî BALANCED
====================================================== */

.product-detail {
  padding: 16px 20px 96px; /* üîë ‡∏î‡∏±‡∏ô content ‡∏´‡∏ô‡∏µ footer */
  text-align: left;
}

.product-detail .product-info {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.product-detail .product-name {
  font-size: 21px;
  line-height: 1.25;
}

.product-detail .product-price {
  font-size: 23px;
}

.product-detail .product-stock {
  font-size: 13px;
  opacity: 0.8;
}

/* ======================================================
   STEP 9.3 ‚Äî QTY SELECTOR (iOS POLISH)
   Replace old version
====================================================== */

.qty-selector {
  display: flex;
  align-items: center;
  justify-content: center;

  gap: 14px;                /* üîë ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î */
  margin: 22px 0 26px;      /* üîë ‡πÑ‡∏°‡πà‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö */
}

/* ‚àí / + buttons (iOS pill) */
.qty-btn {
  width: 40px;              /* üîë ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
  height: 40px;

  border-radius: 50%;
  border: 1px solid var(--glass-border);

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);

  box-shadow:
    0 6px 16px rgba(0,0,0,.18),
    inset 0 1px 0 rgba(255,255,255,.6);

  transition:
    transform 120ms ease,
    box-shadow 120ms ease,
    opacity 120ms ease;
}

.qty-btn:active {
  transform: scale(0.9);
  box-shadow:
    0 4px 10px rgba(0,0,0,.16),
    inset 0 1px 0 rgba(255,255,255,.5);
}

.qty-btn:disabled {
  opacity: 0.35;
}

/* quantity value (iOS-like, smooth change) */
.qty-value {
  width: 44px;
  min-width: 44px;
  height: 40px;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 20px;
  font-weight: 600;
  line-height: 1;

  color: var(--text-primary);

  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.32);

  /* softer glass */
  background:
    linear-gradient(
      to bottom,
      rgba(255,255,255,.22),
      rgba(255,255,255,.12)
    );

  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  /* ‚ú® smooth value perception */
  transition:
    background 160ms ease,
    box-shadow 160ms ease,
    transform 120ms ease,
    opacity 120ms ease;

  will-change: transform, opacity;
}

/* micro feedback when value updates */
.qty-value:active {
  transform: scale(0.96);
  opacity: 0.85;
}


/* ======================================================
   STEP 9.3 ‚Äî ADD TO CART BUTTON (Liquid Glass)
   üîí Add only ‚Äî no override
====================================================== */

.product-detail-footer {
  position: sticky;
  bottom: 0;

  padding: 16px 16px
    calc(16px + env(safe-area-inset-bottom));

  background: linear-gradient(
    to top,
    rgba(255,255,255,0.92),
    rgba(255,255,255,0.65)
  );

  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);

  border-top: 1px solid rgba(0,0,0,0.05);
}

.add-to-cart-btn {
  width: 100%;
  height: 56px; /* ‚¨ÜÔ∏è ‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */

  font-size: 17px;
  font-weight: 600;
  letter-spacing: -0.2px;

  border-radius: 18px;
  border: none;

  color: #fff;

  /* üîµ iOS primary blue (liquid) */
  background:
    linear-gradient(
      to bottom,
      rgba(0,122,255,0.95),
      rgba(0,122,255,0.85)
    );

  box-shadow:
    0 12px 28px rgba(0,122,255,0.45),
    inset 0 1px 0 rgba(255,255,255,0.35);

  transition:
    transform 120ms cubic-bezier(.2,.8,.2,1),
    box-shadow 180ms cubic-bezier(.2,.8,.2,1),
    filter 120ms ease;

  will-change: transform, box-shadow;
}

/* tap feedback ‚Äî iOS heavy press */
.add-to-cart-btn:active {
  transform: scale(0.97) translateY(1px);
  box-shadow:
    0 6px 16px rgba(0,122,255,0.35),
    inset 0 1px 0 rgba(255,255,255,0.25);
  filter: brightness(0.96);
}

/* disabled (future-proof) */
.add-to-cart-btn:disabled {
  opacity: 0.45;
  box-shadow: none;
  filter: none;
}



/* ======================================================
   9.1 PRODUCT DETAIL SHEET (Bottom Sheet) ‚Äî FIXED
   iOS-like Centered Sheet
====================================================== */

.product-detail-sheet {
  position: fixed;
  left: 50%;

  /* üîë FIX ‚Äî iOS-style air gap (‡πÑ‡∏°‡πà‡∏ä‡∏ô‡∏û‡∏∑‡πâ‡∏ô) */
  bottom: 0;

  transform: translate(-50%, 100%);

  width: 100%;
  max-width: 92%;
  max-height: 88dvh;

  display: flex;
  flex-direction: column;

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  border: 1px solid var(--glass-border);

  box-shadow: var(--glass-shadow);

  transition: transform 360ms var(--ease-out);

  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* when overlay is active */
.overlay.show .product-detail-sheet {
  transform: translate(-50%, 0);
}

/* ======================================================
   STEP 9.3 ‚Äî QTY SHEET (iOS POLISH)
   Replace old version
====================================================== */

#qtySheet {
  display: flex;
  align-items: flex-end;
  justify-content: center;

  z-index: 1000;   /* üîë ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ */
}

/* bottom sheet */
.qty-sheet {
  width: 100%;
  max-width: 92%;
  max-height: 70dvh;

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-shadow);

  transform: translateY(100%);
  transition: transform 360ms var(--ease-out);

  overflow-y: auto;
  -webkit-overflow-scrolling: touch;

  display: flex;
  flex-direction: column;   /* ‚úÖ content flow ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á */
}

/* when open */
#qtySheet.show .qty-sheet {
  transform: translateY(0);
}

/* content spacing (A) */
.qty-sheet .sheet-content {
  padding: 24px 22px 28px;   /* üîë ‡πÇ‡∏•‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö */
  text-align: center;
}

/* title */
.qty-sheet .product-name {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 6px;
  letter-spacing: -0.2px;
}

/* price */
.qty-sheet .product-price {
  font-size: 20px;
  font-weight: 700;
  color: var(--accent);
  margin-bottom: 6px;
}

/* helper text (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤) */
.qty-sheet .sheet-subtitle {
  text-align: center;        /* üîë ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
  font-size: 13px;
  font-weight: 500;
  letter-spacing: -0.1px;

  color: var(--text-secondary);

  margin-top: 6px;           /* üîë ‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏ä‡∏∑‡πà‡∏≠/‡∏£‡∏≤‡∏Ñ‡∏≤ */
  margin-bottom: 18px;       /* üîë ‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å QTY ‡∏ä‡∏±‡∏î */
}

/* ======================================================
   QTY SHEET ‚Äî ACTION BUTTONS LAYOUT
   iOS Balanced Primary / Secondary
====================================================== */

.qty-sheet-actions {
  display: flex;        /* üîë ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */
  gap: 12px;            /* üîë ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÅ‡∏ö‡∏ö iOS */
  margin-top: 24px;     /* üîë ‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å qty selector */
}

.qty-sheet-actions button {
  flex: 1;                 /* üîë ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô 50/50 */
  min-height: 48px;           /* üîë iOS tap target */
  border-radius: 14px;     /* üîë iOS action radius */

  font-size: 16px;
  font-weight: 600;
  letter-spacing: -0.2px;
}

.qty-confirm-btn {
  box-shadow:
    0 10px 24px rgba(0,122,255,.45),
    inset 0 1px 0 rgba(255,255,255,.35);
}

.qty-cancel-btn {
  opacity: 0.9;     /* üîë ‡πÄ‡∏ö‡∏≤‡∏•‡∏á‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢ */
}


/* ======================================================
   GLOBAL BACKDROP ‚Äî iOS Liquid Depth
   Replace old web-ish backdrop
====================================================== */

#globalBackdrop {
  position: fixed;
  inset: 0;

  /* ‚ú® layered darkness (not flat black) */
  background:
    linear-gradient(
      to bottom,
      rgba(0,0,0,.22),
      rgba(0,0,0,.38)
    );

  /* iOS-style depth blur */
  backdrop-filter: blur(10px) saturate(1.05);
  -webkit-backdrop-filter: blur(10px) saturate(1.05);

  /* subtle fade */
  opacity: 0;
  transition: opacity 280ms cubic-bezier(.2,.8,.2,1);

  z-index: 900; /* üîë must stay below sheet */
}

/* when overlay is active */
.overlay.show #globalBackdrop {
  opacity: 1;
}

/* üåô Dark mode ‚Äî deeper but shows content separation */
@media (prefers-color-scheme: dark) {
  #globalBackdrop {
    background:
      linear-gradient(
        to bottom,
        rgba(0,0,0,.35),
        rgba(0,0,0,.55)
      );

    backdrop-filter: blur(14px) saturate(1.08);
    -webkit-backdrop-filter: blur(14px) saturate(1.08);
  }
}

/* ======================================================
   CART SHEET ‚Äî iOS 26 / Liquid Glass
====================================================== */

.cart-sheet {
  position: fixed;
  left: 50%;
  bottom: 0;

  transform: translate(-50%, 100%);
  transition: transform 360ms var(--ease-out);

  width: 100%;
  max-width: 92%;
  max-height: 82dvh;

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  border: 1px solid var(--glass-border);

  box-shadow: var(--glass-shadow);

  display: flex;
  flex-direction: column;

  overflow: hidden;
}

.overlay.show .cart-sheet {
  transform: translate(-50%, 0);
}

/* ======================================================
   CART HEADER
====================================================== */

.cart-sheet .sheet-header {
  padding: 18px 20px 10px;
}

.cart-sheet .sheet-title {
  font-size: 20px;
  font-weight: 700;
  letter-spacing: -0.2px;
}

.cart-sheet .sheet-subtitle {
  margin-top: 4px;
  font-size: 14px;
  color: var(--text-secondary);
}

/* ======================================================
   CART CONTENT
====================================================== */

.cart-sheet .sheet-content {
  padding: 8px 16px 0;

  display: flex;
  flex-direction: column;
  gap: 12px;

  /* ‚úÖ PATCH 2 ‚Äî scroll ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ content */
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;

  /* üß† ‡∏Å‡∏±‡∏ô scroll ‡∏ó‡∏∞‡∏•‡∏∏‡πÑ‡∏õ body */
  overscroll-behavior: contain;
}

.cart-sheet .sheet-content {
  position: relative;
}

/* top fade */
.cart-sheet .sheet-content::before {
  content: "";
  position: sticky;
  top: 0;
  height: 14px;
  background: linear-gradient(
    to bottom,
    rgba(255,255,255,0.95),
    rgba(255,255,255,0)
  );
  z-index: 2;
  pointer-events: none;
}

/* bottom fade */
.cart-sheet .sheet-content::after {
  content: "";
  position: sticky;
  bottom: 0;
  height: 14px;
  background: linear-gradient(
    to top,
    rgba(255,255,255,0.95),
    rgba(255,255,255,0)
  );
  z-index: 2;
  pointer-events: none;
}

/* dark mode */
@media (prefers-color-scheme: dark) {
  .cart-sheet .sheet-content::before {
    background: linear-gradient(
      to bottom,
      rgba(28,28,30,0.95),
      rgba(28,28,30,0)
    );
  }
  .cart-sheet .sheet-content::after {
    background: linear-gradient(
      to top,
      rgba(28,28,30,0.95),
      rgba(28,28,30,0)
    );
  }
}

/* ======================================================
   CART EMPTY STATE ‚Äî REMOVE SCROLL FADE
====================================================== */

.cart-sheet .sheet-content:has(.cart-empty-state)::before,
.cart-sheet .sheet-content:has(.cart-empty-state)::after {
  display: none;
}

/* ======================================================
   CART ITEM ‚Äî Card Style (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
====================================================== */

.cart-item {
  display: flex;
  align-items: center;
  gap: 14px;

  padding: 14px 14px;

  background: #fff;
  border-radius: 18px;

  box-shadow:
    0 10px 24px rgba(0,0,0,.08),
    inset 0 1px 0 rgba(255,255,255,.9);

  position: relative;
}

/* dark mode */
@media (prefers-color-scheme: dark) {
  .cart-item {
    background: rgba(28,28,30,.9);
    box-shadow:
      0 14px 28px rgba(0,0,0,.45),
      inset 0 1px 0 rgba(255,255,255,.08);
  }
}

/* ======================================================
   CART EMPTY ‚Äî BACK TO SHOP BUTTON
   iOS Liquid Glass Secondary Action
====================================================== */

.cart-back-btn {
  margin-top: 16px;

  min-height: 44px;                 /* üîë iOS tap target */
  padding: 0 18px;

  border-radius: 14px;
  border: 1px solid var(--glass-border);

  font-size: 15px;
  font-weight: 600;
  letter-spacing: -0.2px;

  color: var(--text-primary);

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  box-shadow:
    0 6px 18px rgba(0,0,0,.16),
    inset 0 1px 0 rgba(255,255,255,.6);

  cursor: pointer;

  transition:
    transform 120ms ease,
    box-shadow 160ms ease,
    background 160ms ease,
    opacity 120ms ease;
}

.cart-back-btn:active {
  transform: scale(0.96);
  box-shadow:
    0 3px 10px rgba(0,0,0,.14),
    inset 0 1px 0 rgba(255,255,255,.45);
  opacity: 0.9;
}

/* ======================================================
   CART ITEM THUMB
====================================================== */

.cart-thumb {
  width: 56px;
  height: 56px;
  flex-shrink: 0;

  border-radius: 14px;
  object-fit: cover;

  background:
    linear-gradient(
      120deg,
      rgba(255,255,255,.2),
      rgba(255,255,255,.08)
    );
}

/* ======================================================
   CART ITEM INFO
====================================================== */

.cart-item-info {
  flex: 1;
  min-width: 0;

  display: flex;
  flex-direction: column;
  gap: 4px;
}

.cart-item-name {
  font-size: 15px;
  font-weight: 600;
  line-height: 1.25;
}

.cart-item-price {
  font-size: 14px;
  color: var(--text-secondary);
}

/* ======================================================
   CART QTY (iOS Pill)
====================================================== */

.cart-qty {
  display: flex;
  align-items: center;
  gap: 10px;

  padding: 6px 12px;
  border-radius: 14px;

  background:
    linear-gradient(
      to bottom,
      rgba(255,255,255,.7),
      rgba(255,255,255,.4)
    );

  border: 1px solid rgba(0,0,0,.05);
}

.cart-qty-value {
  min-width: 20px;
  text-align: center;

  font-size: 15px;
  font-weight: 600;
}

/* ======================================================
   CART ‚Äî Editable Quantity Input
====================================================== */

.cart-qty-editable {
  display: flex;
  align-items: center;
  justify-content: center;

  height: 44px;                 /* iOS tap target */
  padding: 0 10px;

  border-radius: 14px;

  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);

  border: 1px solid var(--glass-border);

  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.35),
    0 6px 16px rgba(0,0,0,.18);
}

.cart-qty-input {
  width: 36px;              /* üîë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏û‡∏≠‡∏î‡∏µ */
  max-width: 40px;

  text-align: center;

  font-size: 15px;
  font-weight: 600;

  color: var(--text-primary);

  border: none;
  background: transparent;
  outline: none;

  appearance: textfield;    /* remove native look */
}

.cart-qty-input::-webkit-inner-spin-button,
.cart-qty-input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.cart-qty-input:focus {
  background: rgba(255,255,255,.12);
  border-radius: 8px;
  transform: scale(1.05);
}


/* ======================================================
   CART REMOVE BUTTON
====================================================== */

.cart-remove {
  width: 32px;
  height: 32px;

  border-radius: 50%;
  border: none;

  background: rgba(255,59,48,.15);
  color: var(--danger);

  font-size: 16px;
  cursor: pointer;

  display: flex;
  align-items: center;
  justify-content: center;

  transition:
    transform 120ms ease,
    background 120ms ease;
}

.cart-remove:active {
  transform: scale(0.9);
  background: rgba(255,59,48,.25);
}

/* ======================================================
   CART FOOTER
====================================================== */

.cart-footer {
  margin-top: auto;

  padding:
    16px 18px
    calc(18px + env(safe-area-inset-bottom));

  background:
    linear-gradient(
      to top,
      rgba(255,255,255,.96),
      rgba(255,255,255,.75)
    );

  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);

  border-top: 1px solid rgba(0,0,0,.06);
}

/* dark mode */
@media (prefers-color-scheme: dark) {
  .cart-footer {
    background:
      linear-gradient(
        to top,
        rgba(28,28,30,.96),
        rgba(28,28,30,.75)
      );
  }
}

/* ======================================================
   CART SUMMARY
====================================================== */

.cart-summary {
  display: flex;
  justify-content: space-between;
  align-items: center;

  font-size: 16px;
  margin-bottom: 14px;
}

.cart-summary strong {
  font-size: 18px;
}

/* ======================================================
   CART SUBMIT BUTTON
====================================================== */

.cart-submit-btn {
  width: 100%;
  height: 54px;

  border-radius: 18px;
  border: none;

  font-size: 17px;
  font-weight: 600;

  color: #fff;

  background:
    linear-gradient(
      to bottom,
      rgba(0,122,255,.95),
      rgba(0,122,255,.85)
    );

  box-shadow:
    0 14px 30px rgba(0,122,255,.45),
    inset 0 1px 0 rgba(255,255,255,.35);

  transition:
    transform 120ms var(--ease-out),
    box-shadow 180ms var(--ease-out),
    filter 120ms ease;
}

.cart-submit-btn:active {
  transform: scale(0.97);
  box-shadow:
    0 6px 16px rgba(0,122,255,.35),
    inset 0 1px 0 rgba(255,255,255,.25);
}

.cart-submit-btn:disabled {
  opacity: 0.45;
  box-shadow: none;
}

/* ======================================================
   10. ORDER DOCUMENT (A4)
====================================================== */

.a4-page {
  max-width: 210mm;     /* ‚¨ÖÔ∏è ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏ö‡∏ö A4 */
  min-height: 297mm;
  width: auto;          /* ‚¨ÖÔ∏è ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ screen ‡∏Ñ‡∏∏‡∏°‡πÄ‡∏≠‡∏á */

  margin: 0 auto;
  padding: 10mm 8mm;

  background: #ffffff;
  color: #000000;

  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: 14px;
  line-height: 1.4;

  box-sizing: border-box;

}

.order-doc .doc-header {
  border-bottom: 2px solid #000;
  margin-bottom: 12mm;
  padding-bottom: 6mm;
}

.order-doc .doc-title {
  font-size: 20px;
  font-weight: 700;
}

.order-doc .doc-meta {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10mm;
  font-size: 13px;
}

.order-doc .doc-table-header,
.order-doc .doc-row {
  display: grid;
  grid-template-columns:
    48px   /* ‡∏£‡∏π‡∏õ */
    90px   /* ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
    1fr    /* ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏¢‡∏∑‡∏î‡πÑ‡∏î‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) */
    90px   /* ‡∏£‡∏≤‡∏Ñ‡∏≤ */
    70px;  /* ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô */
  gap: 8px;
  align-items: center;
}

.order-doc .doc-table-header {
  font-weight: 600;
  border-bottom: 1.5px solid #000;
  padding-bottom: 6px;
}

.order-doc .doc-row {
  padding: 6px 0;
  border-bottom: 1px solid #ddd;

  /* üîë ‡∏Å‡∏±‡∏ô‡πÇ‡∏î‡∏ô‡∏ï‡∏±‡∏î‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ */
  break-inside: avoid;
  page-break-inside: avoid;
}

.doc-items {
  page-break-before: auto;
}

/* ======================================================
   ORDER DOCUMENT ‚Äî TEXT SAFETY
   Screen vs Print Behavior
====================================================== */

/* ======================
   SCREEN (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ / ‡πÄ‡∏ß‡πá‡∏ö)
====================== */
@media screen {

/* ‚úÖ Document screen preview ‚Äî ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà */
body.document-mode .order-doc .doc-row span:nth-child(3) {
  white-space: normal;        /* üîë ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà */
  overflow: visible;
  text-overflow: unset;
  word-break: break-word;     /* üîë ‡∏Å‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡∏ß‡∏°‡∏≤‡∏Å */
}

  /* ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
  .order-doc .doc-row span:nth-child(2) {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
}

/* ======================
   PRINT (A4 ‡∏à‡∏£‡∏¥‡∏á)
====================== */
@media print {

  /* ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚Äî ‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÑ‡∏î‡πâ */
  .order-doc .doc-row span:nth-child(3) {
    white-space: normal;
    overflow: visible;
    text-overflow: unset;
  }

  /* ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚Äî ‡∏¢‡∏±‡∏á‡∏ï‡∏±‡∏î‡πÑ‡∏î‡πâ (‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô) */
  .order-doc .doc-row span:nth-child(2) {
    white-space: nowrap;
  }
}


.order-doc .doc-thumb {
  width: 40px;
  height: 40px;
  object-fit: cover;
  border: 1px solid #ccc;
}

.order-doc .doc-summary {
  margin-top: 12mm;
  padding-top: 6mm;
  border-top: 2px solid #000;

  display: flex;
  justify-content: flex-end;

  font-size: 16px;
  font-weight: 700;
}

/* ======================================================
   DOCUMENT MODE
====================================================== */

body.document-mode #appHeader {
  display: none;
}

/* üìÑ Screen preview background */
body.document-mode {
  background: #f2f2f7;
}

/* ======================================================
   DOCUMENT PREVIEW CONTAINER (SCREEN)
====================================================== */

body.document-mode #app {
  display: flex;
  justify-content: center;
  align-items: flex-start;

  padding: 12px 8px 24px;
  overflow-x: hidden;
}

/* ======================================================
   ORDER DOCUMENT ‚Äî SCREEN PREVIEW
====================================================== */

body.document-mode .a4-page {
  width: 100%;
  max-width: 100%;

  margin: 0 auto 24px;

  /* ‚ú® preview polish */
  box-shadow:
    0 24px 60px rgba(0,0,0,.25);
}

@media screen and (max-width: 480px) {
  body.document-mode .a4-page {
    font-size: 14px;   /* üîë ‡∏Å‡∏±‡∏ô auto zoom */
    line-height: 1.45;
  }
}

@media screen and (max-width: 480px) {
  .order-doc .doc-table-header,
  .order-doc .doc-row {
    grid-template-columns:
      32px
      1fr
      2.4fr
      1.2fr
      0.8fr;
  }
}

  .order-doc .doc-thumb {
    width: 32px;
    height: 32px;
  }
}


/* ======================================================
   ORDER DOCUMENT ‚Äî PRINT
====================================================== */

@media print {

  /* üßª reset screen layout */
  body,
  #app {
    background: #ffffff;
    margin: 0;
    padding: 0;
  }

  body.document-mode #app {
    display: block;
  }

  body.document-mode .a4-page {
    /* ‚úÖ A4 ‡∏à‡∏£‡∏¥‡∏á */
    width: 210mm;
    max-width: 210mm;
    min-height: 297mm;

    /* ‚ùå ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á screen */
    box-shadow: none;
    margin: 0;
    padding: 20mm;
  }

  /* üîí hide UI */
  #appHeader,
  #toastContainer,
  #loadingOverlay {
    display: none !important;
  }
}

@media print {
  @page {
    margin: 20mm;
  }

  .order-doc::after {
    content: "‡∏´‡∏ô‡πâ‡∏≤ " counter(page);
    position: fixed;
    bottom: 10mm;
    right: 20mm;
    font-size: 12px;
    color: #555;
  }
}

/* ======================================================
   NON-PRINT ELEMENTS
   - Hide buttons / actions when printing or exporting
====================================================== */

.no-print {
  margin-top: 16px;
  text-align: center;
}

/* ‚ùå ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ */
@media print {
  .no-print {
    display: none !important;
  }
}

/* ===============================
   DOCUMENT MODE ‚Äî MOBILE FIX
=============================== */
body.document-mode {
  background: #000;           /* ‡∏Å‡∏±‡∏ô‡∏à‡∏≠‡∏î‡∏≥‡∏´‡∏•‡∏≠‡∏Å‡∏ï‡∏≤ */
  overflow-y: auto;           /* üîë ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ scroll */
}

/* Desktop (‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°) */
.a4-page {
  width: 210mm;
  min-height: 297mm;
  margin: 0 auto;
}

/* üì± Mobile */
@media (max-width: 768px) {
  .a4-page {
    width: 100vw;
    min-height: auto;
    padding: 16px;
    box-sizing: border-box;
    transform: scale(0.95);   /* ‡∏Å‡∏±‡∏ô‡∏•‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö */
    transform-origin: top center;
  }

  .order-doc-wrapper {
    overflow-x: hidden;
  }
}

@media (max-width: 768px) {
  .doc-actions {
    position: sticky;
    bottom: 0;
    background: #111;
    padding: 12px;
  }
}
